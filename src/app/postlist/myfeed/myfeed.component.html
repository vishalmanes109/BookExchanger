<app-navbar></app-navbar>
<br />

<div class="ui container">
  <div class="ui container">
    <div class="ui stackable grid">
      <div class="eight wide column">
        <i [routerLink]="['/createpost']" routerLinkActive="router-link-active">
          <div class="ui fluid category search">
            <div class="ui icon input post">
              <input class="" type="text" placeholder="Create Post" />
              <i class="edit outline icon"></i>
            </div>
          </div>
        </i>
      </div>

      <div class="eight wide column">
        <div class="ui right aligned category search">
          <div class="ui icon input post">
            <input
              class="prompt"
              type="text"
              placeholder="Advance search"
              name="advancesearch"
              [routerLink]="['/advancesearch']"
              routerLinkActive="router-link-active"
            />
            <i class="search icon"></i>
          </div>
          <div class="results"></div>
        </div>
      </div>
    </div>
  </div>
</div>
<br />
<div class="ui container">
  <div class="ui menu container">
    <a (click)="myFeedByLocation()" class="item wide">
      <i class="map marker alternate icon"></i>
      Nearby
    </a>
    <a (click)="myFeedByMyPost()" class="item">
      <i class="paperclip icon"></i>
      Your Post
    </a>
    <a (click)="myFeedByNewPost()" class="item">
      <i class="paper plane icon"></i>
      New
    </a>
  </div>
</div>
<br />
<div class="ui stackable grid container">
  <div class="twelve wide column">
    <div class="ui container">
      <h5 *ngIf="isDataFetch" class="ui">
        {{ message }}
      </h5>
    </div>
    <div *ngIf="isDataFetch">
      <div
        *ngFor="
          let post of postData
            | paginate: { itemsPerPage: 2, currentPage: page }
        "
      >
        <div class="ui teal padded segment container">
          <div class="ui">
            <h2>
              {{ post.title }}
            </h2>
          </div>
          <br />

          <div class="ui grid container stackable">
            <div class="six wide column">
              <img
                class="ui rounded fluid centered bordered image"
                src="{{ post.give_book_image }}"
                alt=""
              />
            </div>

            <div class="ten wide column container">
              <div class="details">
                <i
                  [routerLink]="['/profile/', post.name]"
                  routerLinkActive="router-link-active"
                >
                  <img class="ui avatar image" src="{{ post.avatar }}" />
                  Posted by: {{ post.name }}
                </i>

                <hr />
                <div class="details">
                  {{ post.description }}
                </div>
                <div class="details">
                  Book to exchange: {{ post.givebookname }}
                </div>
                <div class="details">
                  Author Name: {{ post.givebookauthor }}
                </div>

                <div
                  class="details"
                  *ngIf="
                    post.takebook !== undefined || post.takebook !== null;
                    else takebooknotpresent
                  "
                >
                  Book want : {{ post.takebookname }}
                </div>
                <ng-template #takebooknotpresent
                  >Book want : {{ takeBook }}</ng-template
                >

                <div class="details">Author Name:{{ post.takebookauthor }}</div>
                <div class="details">
                  Date: {{ post.post_time.substring(0, 10) }}
                </div>
                <!-- <div class="details">Location: {{ post.location }}</div> -->
                <br />
                <div *ngIf="isNearByPost" class="details">
                  {{ post.name }} is :
                  {{ ((post.distance * 1609) / 1000).toFixed(2) }} Km away from
                  your location
                </div>
              </div>
              <input
                *ngIf="yourPost"
                type="button"
                class="ui button primary inverted"
                name="edit"
                value="Edit"
                (click)="editPost(post.postid)"
              />

              <input
                *ngIf="!yourPost"
                type="button"
                class="ui button primary inverted"
                name="chat"
                value="Chat"
              />
              <div
                class="ui icon button orange inverted"
                (click)="generateSharableLink(post.postid, post.title)"
              >
                <i class="share icon"></i>
              </div>
              <div
                *ngIf="!isPostSaved "
                class="ui icon button"
                (click)="savePost(post.postid, post.profileid)"
              >
                <i class="bookmark icon"></i>
              </div>
              <div
                *ngIf="isPostSaved && savePostId != post.postid"
                class="ui icon button"
                (click)="savePost(post.postid, post.profileid)"
              >
                <i class="bookmark icon"></i>
              </div>
              <div
                *ngIf="savePostId == post.postid"
                class="ui icon button green inverted"
                (click)="unSavePost(post.postid, post.profileid)"
              >
                <i class="bookmark icon"></i>
              </div>

              <div *ngIf="!isCopy && isShare && post.postid==sharePostId">
                <p class="ui sharelink">{{ shareLink }}</p>
                <button
                  class="ui button tiny primary"
                  (click)="copyShareableLink(shareLink)"
                >
                  copy
                </button>
              </div>
            </div>
          </div>
        </div>
        <br />
      </div>
      <pagination-controls (pageChange)="page = $event"></pagination-controls>
    </div>

    <div class="ui container" *ngIf="!isDataFetch">
      <div class="ui segment">
        {{ note }}

        <a href="www.bookxchanger.com">BookXchanger</a>
      </div>
      <h3>Most Popular books Available</h3>

      <div class="ui grid container">
        <div *ngFor="let post of bookPost" class="four wide column">
          <img
            class="ui image small bordered centered"
            src="{{ post.give_book_image }}"
            alt="popular books"
          />
        </div>
      </div>
    </div>
  </div>
  <div class="four wide column">
    <p class="ui container">Search posts by book name</p>
    <div class="ui category search">
      <div class="ui icon input">
        <input
          class="prompt"
          type="text"
          placeholder="Search by book name..."
          name="searchbybook"
          [(ngModel)]="bookname"
          (keyup.enter)="getPostByBookName()"
        />
        <i class="search icon"></i>
      </div>
    </div>
    <br />
    <div>
      <ng-container class="ui container" *ngIf="isDataFetch; else elseTemplate">
        <h3>Most Popular books Available</h3>

        <div class="ui grid">
          <div
            *ngFor="let post of bookPost | slice: 0:2"
            class="eight wide column"
          >
            <img
              class="ui image small bordered centered"
              src="{{ post.give_book_image }}"
              alt="popular books"
            />
          </div>
        </div>
      </ng-container>
      <ng-template #elseTemplate>
        <div class="ui segment red container">
          <h3>How BookXchanger works?</h3>
          <div class="ui ordered list">
            <li class="item">Create account</li>
            <li class="item">Submit post</li>
            <li class="item">
              Get match you with other users from nearby location.
            </li>
            <li class="item">
              Chat with other user and decide how to swap book.
            </li>
            <li class="item">Get award points for every succesful swapping.</li>
            <li class="item">
              Search other user with same interest in books to build communty.
            </li>
          </div>
        </div></ng-template
      >

      <div class="ui segment teal container">
        <h3>Why BookXchanger?</h3>
        <h3>Well, let see</h3>
        <div class="ui ordered list">
          <li class="item">Read quality books for free</li>
          <li class="item">Chat with user for seamless book swapping</li>
          <li class="item">Save tones of money.</li>
          <li class="item">Swapping books you can save trees.</li>
          <li class="item">Meet interesting people.</li>
        </div>
      </div>
      <div class="ui segment purple container">
        <h3>Have a question?</h3>
        <a href="mailto:crcevishal@gmail.com">Ask Us</a>
      </div>
    </div>
    <div class="ui segment red container">
      <h3>Contact Us</h3>
      <a href="mailto:crcevishal@gmail.com">Mail BookXchanger</a>
      <br />
      <a href="tel:7977747247">Call BookXchanger</a>
    </div>
  </div>
</div>
